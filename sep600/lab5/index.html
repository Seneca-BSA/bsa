<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Lab 5 : Parallel LCD and Interrupt - BSA Lab Manuals</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
        <link href="../../css/extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Lab 5 : Parallel LCD and Interrupt";
        var mkdocs_page_input_path = "sep600/lab5.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> BSA Lab Manuals
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Lab Manuals</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../ses250/">SES250 Electromagnatics</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../seh500/">SEH500 Microprocessors</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../">SEP600 Embedded Systems</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">BSA Lab Manuals</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a> &raquo;</li>
      <li>Lab 5 : Parallel LCD and Interrupt</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="lab-5-parallel-lcd-and-interrupt">Lab 5 : Parallel LCD and Interrupt</h1>
<p><font size="5">
Seneca College</br>
SEP600 Embedded Systems
</font></p>
<h2 id="introduction">Introduction</h2>
<p>Documentation of the Cortex-M4 instruction set, board user's guide, and the microcontroller reference manual can be found here:</p>
<h3 id="cortex-m4">Cortex M4</h3>
<ul>
<li><a href="https://developer.arm.com/documentation/100166/0001">Arm Cortex-M4 Processor Technical Reference Manual Revision</a></li>
<li><a href="https://developer.arm.com/documentation/ddi0403/latest/">ARMv7-M Architecture Reference Manual</a></li>
</ul>
<h3 id="frdm-k64f">FRDM-K64F</h3>
<ul>
<li><a href="../FRDMK64FUG.pdf">FRDM-K64F Freedom Module User’s Guide</a> (From <a href="https://www.nxp.com/webapp/Download?colCode=FRDMK64FUG">nxp.com</a>)</li>
<li><a href="../K64P144M120SF5RM.pdf">Kinetis K64 Reference Manual</a> (From <a href="https://www.nxp.com/webapp/Download?colCode=K64P144M120SF5RM">nxp.com</a>)</li>
<li><a href="https://os.mbed.com/platforms/FRDM-K64F/">FRDM-K64F mbed</a></li>
</ul>
<h3 id="frdm-k66f">FRDM-K66F</h3>
<ul>
<li><a href="../FRDMK66FUG.pdf">FRDM-K66F Freedom Module User’s Guide</a> (From <a href="https://www.nxp.com/webapp/Download?colCode=FRDMK66FUG">nxp.com</a>)</li>
<li><a href="../K66P144M180SF5RMV2.pdf">Kinetis K66 Reference Manual</a> (From <a href="https://www.nxp.com/webapp/Download?colCode=K66P144M180SF5RMV2">nxp.com</a>)</li>
<li><a href="https://os.mbed.com/platforms/FRDM-K66F/">FRDM-K66F mbed</a></li>
</ul>
<h2 id="materials">Materials</h2>
<ul>
<li>Safety glasses (PPE)</li>
<li>Breadboard</li>
<li>LCD Display (Parallel**)</li>
<li>1kΩ Resistors</li>
<li>Jumper Wires</li>
</ul>
<p>** If you are using an I2C LCD, connect the LCD to the I2C pins and use the I2C library instead of the parallel LCD library.</p>
<h2 id="preparation">Preparation</h2>
<blockquote>
<h3 id="lab-preparation-question">Lab Preparation Question</h3>
<ol>
<li>Read over the lab and understand the procedures.</li>
</ol>
</blockquote>
<h2 id="procedures">Procedures</h2>
<h3 id="part-1-parallel-lcd">Part 1: Parallel LCD</h3>
<p>In Part 1, we'll take a look at how to connect and display characters to a parallel LCD.</p>
<p>A parallel 16x2 LCD shown in Figure 5.1 usually uses 4-wire for parallel data transfer plus 2-wire for enable and register select. A 8-wire data configuration is sometimes used but normally not required.</p>
<p><img alt="Figure 5.1" src="../lab5-lcd.png" /></p>
<p><em><strong>Figure 5.1</strong> 16x2 LCD</em></p>
<p>The typical pinout and connection for a 16x2 LCD are given below. Please keep in mind that depending on the manufacturer, some labels and configurations may vary.</p>
<table>
<thead>
<tr>
<th>LCD Pin #</th>
<th>LCD label</th>
<th>K64F/K66F Pin</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>GND / VSS</td>
<td>GND / 0V</td>
</tr>
<tr>
<td>2</td>
<td>VDD / VCC</td>
<td>5V</td>
</tr>
<tr>
<td>3</td>
<td>VO</td>
<td>1kΩ to GND / 0V</td>
</tr>
<tr>
<td>4</td>
<td>RS</td>
<td>D9</td>
</tr>
<tr>
<td>5</td>
<td>R/W</td>
<td>GND / 0V</td>
</tr>
<tr>
<td>6</td>
<td>E</td>
<td>D8</td>
</tr>
<tr>
<td>7</td>
<td>DB0</td>
<td>N/C</td>
</tr>
<tr>
<td>8</td>
<td>DB1</td>
<td>N/C</td>
</tr>
<tr>
<td>9</td>
<td>DB2</td>
<td>N/C</td>
</tr>
<tr>
<td>10</td>
<td>DB3</td>
<td>N/C</td>
</tr>
<tr>
<td>11</td>
<td>DB4</td>
<td>D4</td>
</tr>
<tr>
<td>12</td>
<td>DB5</td>
<td>D5</td>
</tr>
<tr>
<td>13</td>
<td>DB6</td>
<td>D6</td>
</tr>
<tr>
<td>14</td>
<td>DB7</td>
<td>D7</td>
</tr>
<tr>
<td>15</td>
<td>LED+</td>
<td>1kΩ to 5V</td>
</tr>
<tr>
<td>16</td>
<td>LED-</td>
<td>N/C</td>
</tr>
</tbody>
</table>
<ul>
<li>Some models work with 3.3V instead of 5V</li>
<li>VO pin configuration varies depending on the manufacturer. A potentiometer can be used instead of a 1kΩ Resistor for adjustable contrast</li>
</ul>
<p>You may change the pin to use on the K64F/K66F board depending on your application and pin availability.</p>
<ol>
<li>
<p>Acquire an LCD and resistor then connect them to the Freedom K64F/K66F board as per the connection table given above and the diagram below. If you are using an I2C LCD, connect the LCD to an I2C pin.</p>
<p><img alt="Figure 5.2" src="../lab5-lcd-connection.png" /></p>
<p><em><strong>Figure 5.2</strong> LCD connection with Freedom board</em></p>
</li>
<li>
<p>Open mbed Studio and install the following library to your project depending if you are using the Parallel or I2C version of the LCD.</p>
<ul>
<li>Parallel LCD: https://os.mbed.com/users/sstaub/code/mbedLCD/</li>
<li>I2C LCD: https://os.mbed.com/users/sstaub/code/mbedLCDi2c/</li>
</ul>
</li>
<li>
<p>Use the following code to output some message on the display.
    <pre></p>
<pre><code>#include "mbed.h"
#include "LCD.h"

LCD lcd(D9, D8, D4, D5, D6, D7, LCD16x2); // RS, EN, D4-D7, Type

int main() {

    lcd.cls(); // clear display
    lcd.locate(0, 0); // set cursor location
    lcd.printf("START\n"); // display text
    ThisThread::sleep_for(2s);
    lcd.cls(); // clear display
    lcd.locate(0, 0); // set cursor location
    lcd.printf("Hello World!\n"); // display text

}
</code></pre>
</pre>
</li>
<li>
<p>After uploading your code, the LCD should show "START" for 2 seconds then "Hello World!".</p>
<blockquote>
<p><strong>Lab Question:</strong> Modify your code to display your name and student number on row 1 and your lab partner's name and student name on row 2 (or be creative like "SEP600 Embedded System is Awesome"). Since the message will be too wide for the LCD, display the text as a horizontal scrolling message at a reasonable rate. </p>
<p><strong>Hint:</strong> There are many ways to do this. Refer to the library documentation on how to move the print cursor.</p>
</blockquote>
</li>
</ol>
<h3 id="part-2-interrupt">Part 2: Interrupt</h3>
<p>Interrupt is a way for the microcontroller to listen to events without continuously polling from the input.</p>
<ol>
<li>
<p>Connect a pull-up or pull-down button to any digital pin of your choosing.</p>
</li>
<li>
<p>Add the following code before <code>main()</code> to create an interrupt object.
    <pre></p>
<pre><code>InterruptIn button(PTXX);
</code></pre>
</pre>
</li>
<li>
<p>Add the following interrupt routine before <code>main()</code> and add the appropriate code for displaying a message on the LCD.
    <pre></p>
<pre><code>void button_isr(){
    // display an interrupt messages on the LCD
    // USE wait_us for delay
    // DO NOT use ThisThread::sleep_for
}
</code></pre>
</pre>
</li>
<li>
<p>Within <code>main()</code> Attach the interrupt routine with the button and adjust for rise or fall edge depending on your circuit configuration.
    <pre></p>
<pre><code>button.rise(&amp;button_isr);
</code></pre>
</pre>
</li>
<li>
<p>Upload and test your interrupt.</p>
</li>
</ol>
<h2 id="reference">Reference</h2>
<ul>
<li><a href="https://os.mbed.com/docs/mbed-os/v6.16/apis/interruptin.html">InterruptIn</a></li>
</ul>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme_extra.js" defer></script>
    <script src="../../js/theme.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
